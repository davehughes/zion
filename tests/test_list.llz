module _
link module posix
# test: skip

type Done tag

type NodeInt has {
	value __int__
	next ListInt
}

type ListInt is {
	NodeInt
	Done
}

fn len(l ListInt) __int__ {
	match l {
		Done: {
			return 0
		}
		NodeInt: {
			return call __plus__(1, call len(l.next))
		}
	}
	return 0
}

fn sum(l ListInt) __int__ {
	match l {
		Done: {
			return 0
		}
		NodeInt: {
			return call __plus__(l.value, call sum(l.next))
		}
	}
	return 0
}

fn main() void {
	const l ListInt = call NodeInt(1, call NodeInt(2, call NodeInt(3, Done)))
	call puts(call __str__(call len(l)))
	call puts(call __str__(call sum(l)))
}
